import"./time.js";import"./lyric.js";import"./channels.js";let t,e,i,l,a,r={class:"xl-bi"},o={class:"xl-bz"},s={class:"xl-bk"};import n from"../../lib/magix.js";import c from"../../gallery/mx-dragdrop/index.js";import p from"./player.js";n.applyStyle("xl-o",".xl-a7{color:#fff;height:30px;position:relative;top:-65px;transition:top .2s}.xl-a8{-ms-overflow-style:none;scrollbar-width:thin}.xl-a8::-webkit-scrollbar{height:0;width:0}.xl-a8:hover::-webkit-scrollbar{width:2px}.xl-a8::-webkit-scrollbar-corner{height:0;width:0}.xl-a8::-webkit-scrollbar-thumb{background:#fff7;border-radius:2px}.xl-a8::-webkit-scrollbar-thumb:hover{background:#fff}.xl-a9{background:#0008;border-radius:4px;height:190px;overflow:auto;padding:4px;position:absolute;right:0;top:52px;transition:all .25s;width:672px;z-index:1}.xl-b_{height:480px;width:672px}.xl-ba{top:0}.xl-bb{height:22px;right:5px;top:0;width:20px}.xl-bc{border:1px solid transparent;border-radius:5px;cursor:pointer;float:left;height:90px;margin:2px;text-align:center;width:78px}.xl-bc:hover{border-color:#fff3;opacity:.6}.xl-bd{border-color:#fff}.xl-bd:hover{border-color:#fff;opacity:1}.xl-be{align-items:center;display:inline-flex;height:60px;justify-content:center;width:68px}.xl-bf{height:auto;max-height:100%;max-width:100%;width:auto}.xl-bg{background-color:#aaa;background-repeat:no-repeat;background-size:cover;border:1px solid #fff;float:left;height:50px;margin:-12px 2px 2px;width:50px}.xl-bh{background:#333;border-radius:50%;box-shadow:0 0 0 3px #fffb;height:8px;margin:50%;transform:translate(-4px,-4px);width:8px}.xl-bi{background:#333;border-radius:4px;height:30px;line-height:30px;padding:0 5px;position:relative;width:600px;z-index:2}.xl-bj{float:left;font-size:12px;margin:0 5px;overflow:hidden;position:relative;width:100px}.xl-bk{background:#333;left:0;position:absolute;top:0;width:100px}@-webkit-keyframes xl-a{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes xl-a{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.xl-bg{-webkit-animation:xl-a 8s linear infinite;animation:xl-a 8s linear infinite;border-radius:50%;border-width:3px;cursor:pointer}.xl-bl{border:1px solid transparent;border-radius:2px;cursor:pointer;display:block;float:left;height:20px;margin-top:4px;width:20px}.xl-bl:hover{border-color:#fff;opacity:.6}.xl-bm{cursor:not-allowed;opacity:.6}.xl-bm:hover{border-color:transparent}.xl-bn{border-color:#fff}.xl-bo{align-items:center;display:inline-flex;float:left;height:30px}.xl-bp{width:240px}.xl-bq{transform:rotate(180deg)}.xl-br{font-size:12px}.xl-bs{margin:0 10px;width:80px}.xl-bt{font-size:12px;margin:0 10px}.xl-bu{background:#0008;border-radius:4px;cursor:move;height:60px;left:210px;overflow:hidden;position:absolute;text-align:center;top:65px;width:400px;z-index:1}.xl-bv{color:#ddd;font-size:12px;height:20px;line-height:20px;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.xl-bw{color:#fff;font-size:14px;font-weight:700;opacity:1}.xl-bx{height:14px;position:absolute;right:5px;top:0;width:14px}@-webkit-keyframes xl-b{0%{transform:translate(0)}to{transform:translate(-50%)}}@keyframes xl-b{0%{transform:translate(0)}to{transform:translate(-50%)}}.xl-by{-webkit-animation:xl-b 20s linear infinite;animation:xl-b 20s linear infinite;border-spacing:0;display:table}.xl-bz{display:table-cell;min-width:100px;white-space:nowrap}.xl-bA{-webkit-animation-play-state:paused;animation-play-state:paused}.xl-bB{-webkit-animation-name:none;animation-name:none;padding-left:0}");export default n.View.extend({tmpl:(n,c,p)=>{let x,h,d,b,f,m,g,u,v,{active:w,buffer:_,song:k,play:y,undo:z,ptip:H,reset:V,ntip:M,mode:j,error:A,cshow:B}=n;if(u=[],w){let n,x=_||!k.picture||!y;t?b=[t]:(d=v?[v]:[v=c(0,'<path d="M660.823 334.436H641.59c-9.072 0-16.402 7.33-16.402 16.403v132.6c-1.887-1.523-3.92-3.047-6.242-4.426L393.37 339.299c-25.548-15.822-46.45-4.21-46.45 25.91v293.582c0 30.047 20.684 41.297 45.942 25.04l226.663-146.392c2.033-1.306 3.92-2.758 5.662-4.21v139.424c0 9.073 7.33 16.403 16.402 16.403h19.233c9.073 0 16.403-7.331 16.403-16.403V350.839c0-9.073-7.331-16.403-16.403-16.403z" fill="#fff"/>',1)],b=[t=c("svg",{_:"_",viewBox:"0 0 1024 1024"},d)]),h="xl-bl xl-bq",z||(h+=" xl-bm"),g=[c("span",{"mx5-click":z&&p+"\x1e_a4()",title:H,class:h},b)],b=e?[e]:[e=c("div",{_:"a",class:"xl-bh"})],h="xl-bg",x&&(h+=" xl-bA"),V&&(h+=" xl-bB"),g.push(c("div",{"mx5-click":!_&&k.picture&&p+"\x1e_a9()",style:null!=k.picture&&"background-image:url("+k.picture+")",class:h},b)),t?b=[t]:(d=v?[v]:[v=c(0,'<path d="M660.823 334.436H641.59c-9.072 0-16.402 7.33-16.402 16.403v132.6c-1.887-1.523-3.92-3.047-6.242-4.426L393.37 339.299c-25.548-15.822-46.45-4.21-46.45 25.91v293.582c0 30.047 20.684 41.297 45.942 25.04l226.663-146.392c2.033-1.306 3.92-2.758 5.662-4.21v139.424c0 9.073 7.33 16.403 16.402 16.403h19.233c9.073 0 16.403-7.331 16.403-16.403V350.839c0-9.073-7.331-16.403-16.403-16.403z" fill="#fff"/>',1)],b=[t=c("svg",{_:"_",viewBox:"0 0 1024 1024"},d)]),g.push(c("span",{class:"xl-bl","mx5-click":p+"\x1e_aW()",title:M},b)),b=[],"rdm"==j?i?b.push(i):(d=[c(0,'<path d="M229.555 408.457h103.542c5.192 0 20.672 5.192 25.863 10.382l36.245 36.245c10.382 15.573 31.054 15.573 46.534 0 15.573-10.382 15.573-31.053 0-46.534l-36.245-36.245c-15.48-15.48-46.534-31.053-72.489-31.053h-103.45c-20.671 0-31.053 15.573-31.053 31.053 0 20.579 15.573 36.152 31.053 36.152z" fill="#fff"/><path d="M617.771 408.457h56.916v41.436c0 10.382 5.191 15.573 15.573 10.382l119.023-77.588c10.382-5.191 10.382-15.573 0-20.671L690.26 284.428c-10.382-5.191-15.573 0-15.573 10.382v56.824h-56.916c-51.725 0-62.106 25.863-98.351 62.106L400.397 584.303c-20.672 20.671-82.779 41.435-113.833 41.435h-56.916c-20.671 0-31.053 15.48-31.053 31.054 0 20.671 15.48 31.053 31.053 31.053h56.916c51.725 0 124.215-25.863 160.459-62.106L566.046 454.99c25.863-25.863 20.672-46.534 51.725-46.534z" fill="#fff"/><path d="M809.283 646.503L690.26 563.725c-10.382-5.191-15.573 0-15.573 10.382v51.725h-56.916c-5.191 0-20.671-5.19-25.863-10.382l-36.245-36.244c-10.382-15.574-31.053-15.574-46.534 0-15.48 10.382-15.48 31.053 0 46.534l36.245 36.244c15.574 15.48 46.534 31.054 72.49 31.054h56.915v41.436c0 10.382 5.192 15.48 15.574 10.382l119.023-77.588c10.196-5.191 10.196-15.573-.093-20.764z" fill="#fff"/>',1)],b.push(i=c("svg",{_:"b",viewBox:"0 0 1024 1024"},d))):l?b.push(l):(d=[c(0,'<path fill="#fff" d="M841.8 513.1c0 .1 0 .1 0 0 0 106.1-86 192.1-192 192.1H393.7c-106 0-192-86-192-192s86-192 192-192h309.8v77.1l186.8-107.8-186.8-107.9v74H392.7c-141.4 0-256.1 114.6-256.1 256.1 0 141.4 114.6 256.1 256.1 256.1h256c141.3 0 255.9-114.4 256.1-255.7h-63z"/><path fill="#fff" d="M542.7 626.5V388h-10.1c-4.1 3.6-9 7.2-14.6 11-5.6 3.7-11.6 7.3-18 10.7-6.3 3.4-12.8 6.5-19.4 9.3-6.6 2.8-12.8 5-18.6 6.6v27c5.2-1.3 10.5-3.1 16-5.4 5.5-2.3 10.7-4.7 15.6-7.3 4.9-2.6 9.4-5.2 13.3-7.9 4-2.7 7-5 9-7.1v201.6h26.8z"/>',1)],b.push(l=c("svg",{_:"c",viewBox:"0 0 1024 1024"},d))),f="\u6b63\u5728",f+="rdm"==j?"\u968f\u673a\u64ad\u653e":"\u5355\u66f2\u5faa\u73af",g.push(c("span",{class:"xl-bl","mx5-click":p+"\x1e_ba()",title:f},b)),b=[],m=[c(0,k.title+"<"+k.artist+">\u2003\u2003\u2003\u2003")],d=[c("div",o,m)],m=[c(0,k.title+"<"+k.artist+">\u2003\u2003\u2003\u2003")],d.push(c("div",o,m)),h="xl-by",x&&(h+=" xl-bA"),V&&(h+=" xl-bB"),b.push(c("div",{class:h},d)),A?n=A:y||_?_&&(n="\u6b63\u5728\u7f13\u51b2..."):n="\u70b9\u51fb\u5149\u76d8\u5f00\u59cb\u64ad\u653e",n&&(d=[c(0,n)],b.push(c("span",s,d))),g.push(c("div",{class:"xl-bj",title:k.title+"<"+k.artist+">"},b),c("div",{"mx5-owner":p,"mx5-from":p,"mx5-view":"~xl/plugins/mplayer/time",class:"xl-bo"})),a?b=[a]:(d=[c(0,'<path fill="#fff" d="M343.25 512h-112.5c-61.875 0-112.5 50.625-112.5 112.5V737c0 61.875 50.625 112.5 112.5 112.5h112.5c61.875 0 112.5-50.625 112.5-112.5V624.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25h-112.5c-30.938 0-56.25-25.313-56.25-56.25V624.5c0-30.938 25.313-56.25 56.25-56.25h112.5c30.938 0 56.25 25.313 56.25 56.25V737zM737 118.25H624.5c-61.875 0-112.5 50.625-112.5 112.5v112.5c0 61.875 50.625 112.5 112.5 112.5H737c61.875 0 112.5-50.625 112.5-112.5v-112.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25H624.5c-30.938 0-56.25-25.313-56.25-56.25v-112.5c0-30.938 25.313-56.25 56.25-56.25H737c30.938 0 56.25 25.313 56.25 56.25v112.5zM737 512H624.5C562.625 512 512 562.625 512 624.5V737c0 61.875 50.625 112.5 112.5 112.5H737c61.875 0 112.5-50.625 112.5-112.5V624.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25H624.5c-30.938 0-56.25-25.313-56.25-56.25V624.5c0-30.938 25.313-56.25 56.25-56.25H737c30.938 0 56.25 25.313 56.25 56.25V737zm-450-618.75h-112.5c-61.875 0-112.5 50.625-112.5 112.5v112.5c0 61.875 50.625 112.5 112.5 112.5h112.5c61.875 0 112.5-50.625 112.5-112.5v-112.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25h-112.5c-30.938 0-56.25-25.313-56.25-56.25v-112.5c0-30.938 25.313-56.25 56.25-56.25h112.5c30.938 0 56.25 25.313 56.25 56.25v112.5z"/>',1)],b=[a=c("svg",{_:"d",viewBox:"0 0 1024 1024"},d)]),g.push(c("span",{class:"xl-bl","mx5-click":p+"\x1e_b_()",title:"\u5f53\u524d\u5206\u7c7b\uff1a"+w.name},b)),u.push(c("div",r,g),c("div",{"mx5-owner":p,"mx5-from":p,"mx5-view":"~xl/plugins/mplayer/lyric",class:"xl-bu","mx5-mousedown":p+"\x1e_bb()"}))}return h="xl-a9 xl-a8",w&&!B&&(h+=" xl-bb"),u.push(c("div",{"mx5-owner":p,"mx5-from":p,"mx5-view":"~xl/plugins/mplayer/channels","mx5-change":p+"\x1e_aU()",class:h})),h="xl-a7",w&&(h+=" xl-ba"),x=[c("div",{class:h},u)],c(p,0,x)},init(){p.on("_aV",(()=>{if("rdm"==this.get("mode")){let t=this.get("active");p._aW(t.channel_id)}else p._aX()})),p.on("_aY",(t=>{let e={};n.has(t,"play")&&(e.play=t.play),n.has(t,"buffer")&&(e.buffer=t.buffer),this.digest(e)})),p.on("_aZ",(()=>{this.set({reset:!1}),this.render()})),p.on("_a0",(t=>{this.digest({reset:!0,song:t.song})}));let t=navigator.mediaSession;t&&(t.setActionHandler("play",(()=>{p._a1()&&(p._a2(),t.playbackState="playing")})),t.setActionHandler("pause",(()=>{p._a1()&&(p._a3(),t.playbackState="paused")})),t.setActionHandler("seekbackward",(()=>{})),t.setActionHandler("seekforward",(()=>{})),t.setActionHandler("previoustrack",(()=>{p._a1()&&p._a4()})),t.setActionHandler("nexttrack",(()=>{if(p._a1()){let t=this.get("active");p._aW(t.channel_id)}}))),this.set({cshow:!1,reset:!0,mode:"rdm",song:{title:"\u8f6f\u4ef6\u4f5c\u8005",artist:"\u884c\u5217"}})},render(){this.digest({ptip:p._a5(),ntip:p._a6(),undo:p._a7()})},_a8(){this.get("play")?p._a3():p._a2()},"_aU<change>"(t){this.digest({active:t.channel}),p._aW(t.channel.channel_id,!0)},"_a9<click>"(){this._a8()},"_b_<click>"(){this.digest({cshow:!this.get("cshow")})},"_aW<click>"(){let t=this.get("active");p._aW(t.channel_id)},"_a4<click>"(){p._a4()},"_ba<click>"(){"rdm"==this.get("mode")?this.digest({mode:"circle"}):this.digest({mode:"rdm"})},"_bb<mousedown>"(t){let e=t.eventTarget,i=parseInt(getComputedStyle(e).left),l=parseInt(getComputedStyle(e).top);this._d(t,(a=>{let r=a.pageX-t.pageX,o=a.pageY-t.pageY,s=i+r,n=l+o;e.style.left=s+"px",e.style.top=n+"px"}))},"$doc<keyup>"(t){if(p._a1()){let e=t.keyCode;if(13==e||32==e)this._a8();else if(80==e)p._a4();else if(78==e){let t=this.get("active");p._aW(t.channel_id)}else 67==e&&this.digest({cshow:!this.get("cshow")})}},"$doc<visibilitychange>"(){p._bc(document.hidden)},"$doc<click>"(t){p._a1()&&this.get("cshow")&&(n.inside(t.target,this.root)||this.digest({cshow:!1}))}}).merge(c);