let t;import i from"../lib/magix.js";import e from"../gallery/mx-dragdrop/index.js";import s from"./ctrl.js";import l from"./exchange.js";export default i.View.extend({tmpl:(i,e,s,l,h,d)=>{let a,o,p,_,x,m,{show:n,active:g,maxState:r,left:c,top:u,width:w,height:y,zIndex:f,appId:v,icon:I,title:k,min:S,max:L,close:z,view:X,scroll:Y,data:b,resize:j}=i;return m=[],_=[e(0,I,1)],o="xl-i",g&&(o+=" xl-j"),x=[e("div",{class:o},_),e(0,k)],m.push(e("div",{class:"xl-h","mx5-mousedown":s+"\x1e\x1e_0()",id:v+"_d_t"},x)),x=[],S&&x.push(e("span",{class:"xl-m xl-o","mx5-click":s+"\x1e_V()"})),L&&(o="xl-m xl-p",r&&(o+=" xl-r"),x.push(e("span",{"mx5-click":s+"\x1e_W()",class:o}))),z&&x.push(e("span",{class:"xl-m xl-n","mx5-click":s+"\x1e_X()"})),o="xl-k",g&&(o+=" xl-q"),m.push(e("div",{class:o},x)),t?x=[t]:(_=[e(0,"loading...")],x=[t=e("div",{_:"_",class:"xl-w"},_)]),o="xl-u",Y&&(o+=" xl-v"),m.push(e("div",{"mx5-owner":s,"mx5-from":s,$:"maxState,data","mx5-view":X+"?maxState="+d(h,r,"_")+"&data="+d(h,b,"a"),class:o},x)),p="",g&&(p+="display:none"),m.push(e("div",{class:"xl-x",style:p}),e("div",{class:"xl-x xl-y",id:s+"_mk"})),j&&!r&&(o="xl-s",g&&(o+=" xl-t"),m.push(e("div",{"mx5-mousedown":s+"\x1e\x1e_1()",class:o}))),o="xl-g xl-z",n&&(o+=" xl-A"),g&&(o+=" xl-l"),p="",r||(p+="left:"+c+"px;top:"+u+"px;width:"+w+"px;height:"+y+"px;"),p+="z-index:"+f,a=[e("div",{id:s+"_d","mx5-mousedown":s+"\x1e_Y()",class:o,style:p},m)],e(s,0,a)},init(t){let i=t.maxState?4:8;i|=2,this._L=i,l.fire("_M",{icon:t.icon,title:t.title,appId:t.appId});let e=this.root;this.on("destroy",(()=>{s._A(this.get("appId")),e.parentNode.removeChild(e),l.fire("_N",{id:this.get("appId")})}))},assign(t){return this.set(t),!0},render(){this.digest()},_O(){let t=this._L;2&t&&(this._L=2^t|1,this.root.style.display="",this.digest({show:!0}))},_G(){let t=this._L;1&t&&(this._L=1^t|2,s._B(this.get("appId")),l.fire("_P",{id:this.get("appId")}),this.digest({show:!1}),this.root.style.display="none")},_z(){this.get("show")?this.digest({active:!0}):(this.set({active:!0}),this._O()),l.fire("_Q",{id:this.get("appId")})},_I(){this.digest({active:!1}),l.fire("_R",{id:this.get("appId")})},_S(){let t=i.node(this.id+"_mk");t&&(t.style.display="block")},_T(){let t=i.node(this.id+"_mk");t&&(t.style.display="none")},_U(){let t=this._L;4&t?(this._L=4^t|8,this.digest({maxState:!1})):(this._L=8^t|4,this.digest({maxState:!0}))},"_V<click>"(){this._G()},"_W<click>"(){this._U()},"_X<click>"(t){this.owner.unmount()},"_Y<mousedown>"(){s._z(this.get("appId"))},"_0<mousedown>"(t){let e=this._L,s=getComputedStyle(document.body),l=parseInt(s.getPropertyValue("--xl-_")),h=document.body.clientWidth,d=document.body.clientHeight-l,a=i.node(this.id+"_d").style,{left:o,top:p,width:_}=this.get(),x=!1;this._S(),this._d(t,(i=>{if(x=!0,4==(4&e))return;let s=i.pageX-t.pageX+o;s<50-_?s=50-_:s>h-50&&(s=h-50);let m=i.pageY-t.pageY+p;m<0?m=0:m>d-50+l&&(m=d-50+l),a.left=s+"px",a.top=m+"px",this.set({left:s,top:m})}),(t=>{if(this._T(),!x&&this.get("max")){let t=Date.now();if(this._Z){t-this._Z<300?(this._Z="",this._U()):this._Z=t}else this._Z=t}}))},"_1<mousedown>"(t){let e=i.node(this.id+"_d").style,{width:s,height:l,minWidth:h,minHeight:d}=this.get();this._S(),this._d(t,(i=>{let a=i.pageX-t.pageX+s;a<h&&(a=h);let o=i.pageY-t.pageY+l;o<d&&(o=d),e.width=a+"px",e.height=o+"px",this.set({width:a,height:o})}),(()=>{this._T()}))}}).merge(e);